<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ú–∞–≥–∞–∑–∏–Ω</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>

<header>
    –û–Ω–ª–∞–π–Ω-–º–∞–≥–∞–∑–∏–Ω –ø–æ–∫—É–ø–æ–∫
</header>

{% with messages = get_flashed_messages() %}
  {% if messages %}
    {% for message in messages %}
      <div class="message">{{ message }}</div>
    {% endfor %}
  {% endif %}
{% endwith %}

<main>

    <!-- –¢–æ–≤–∞—Ä—ã -->
    <div class="block">
        <h2>–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h2>
        <form action="/add" method="post">
            <table>
    <tr><th>#</th><th>–ù–∞–∑–≤–∞–Ω–∏–µ</th><th>–¶–µ–Ω–∞</th><th>–í–µ—Å</th><th></th></tr>
    {% for p in products %}
        <tr>
            <form action="/add" method="post">
                <td>{{ loop.index0 }}</td>
                <td>{{ p.name }}</td>
                <td>{{ p.price }}‚ÇΩ</td>
                <td>
                    {% if p.requires_weight %}
                        <input type="text" name="weight" placeholder="–∫–≥">
                    {% else %}
                        -
                    {% endif %}
                </td>
                <td>
                    <input type="hidden" name="product_index" value="{{ loop.index0 }}">
                    <input type="submit" value="–í –∫–æ—Ä–∑–∏–Ω—É">
                </td>
            </form>
        </tr>
    {% endfor %}
</table>
        </form>
    </div>

    <!-- –ö–æ—Ä–∑–∏–Ω–∞ -->
    <div class="block">
        <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
        {% if cart %}
            <ul>
                {% for item in cart %}
                    <li>{{ item.name }} ‚Äî {{ item.price }}‚ÇΩ</li>
                {% endfor %}
            </ul>
            <p><strong>–ò—Ç–æ–≥–æ –∫ –æ–ø–ª–∞—Ç–µ:</strong> {{ total }}‚ÇΩ</p>
        {% else %}
            <p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>
        {% endif %}
    </div>

    <!-- –û–ø–ª–∞—Ç–∞ -->
    <div class="block">
        <h2>–û–ø–ª–∞—Ç–∞</h2>
        <form action="/buy" method="post">
            <p><label>–ù–∞–ª–∏—á–Ω—ã–µ: <input type="number" name="cash" value="0" min="0"></label></p>
            <p><label>–ö–∞—Ä—Ç–∞: <input type="number" name="card" value="0" min="0"></label></p>
            <p><label>–ë–æ–Ω—É—Å—ã: <input type="number" name="bonus" value="0" min="0"></label></p>
            <input type="submit" value="–û–ø–ª–∞—Ç–∏—Ç—å">
        </form>

        <div class="balance">
            <h3>–í–∞—à –±–∞–ª–∞–Ω—Å:</h3>
            <ul>
                <li>–ù–∞–ª–∏—á–Ω—ã–µ: {{ balance.cash }}‚ÇΩ</li>
                <li>–ö–∞—Ä—Ç–∞: {{ balance.card }}‚ÇΩ</li>
                <li>–ë–æ–Ω—É—Å—ã: {{ balance.bonus }}‚ÇΩ</li>
            </ul>
            <form action="/work">
                <button type="submit">–ü–æ–π—Ç–∏ –Ω–∞ —Ä–∞–±–æ—Ç—É üíº</button>
            </form>
        </div>
    </div>

    <!-- –ò—Å—Ç–æ—Ä–∏—è -->
    <div class="history">
    {% for record in history %}
        <div class="history-item">
            <strong>–ü–æ–∫—É–ø–∫–∞ –Ω–∞ {{ record.total }}‚ÇΩ</strong>
            <ul>
                <li>–ù–∞–ª–∏—á–Ω—ã–µ: {{ record.method.cash }}</li>
                <li>–ö–∞—Ä—Ç–∞: {{ record.method.card }}</li>
                <li>–ë–æ–Ω—É—Å—ã: {{ record.method.bonus }}</li>
            </ul>
            <em>–¢–æ–≤–∞—Ä—ã:</em>
            <ul>
                {% for product in record["items"] %}
                    <li>{{ product[0] }} ‚Äî {{ product[1] }}‚ÇΩ</li>
                {% endfor %}
            </ul>
        </div>
    {% endfor %}
</div>


</main>
</body>
</html>
